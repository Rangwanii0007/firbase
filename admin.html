<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard</title>
  <style>
    body {
      margin: 0;
      background: #000;
      color: #00ffcc;
      font-family: "Courier New", monospace;
      overflow: hidden;
    }
    #login-section, #dashboard {
      display: none;
      height: 100vh;
      width: 100vw;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    #login-section.active, #dashboard.active {
      display: flex;
    }
    input, button {
      background: #111;
      border: 1px solid #0ff;
      color: #0ff;
      padding: 10px;
      margin: 5px;
      border-radius: 6px;
    }
    button:hover { background: #0ff; color: #000; cursor: pointer; }
    #earth-container {
      position: absolute;
      top:0; left:0; width:100%; height:100%;
      z-index:-1;
    }
    #user-list {
      background: rgba(0,0,0,0.7);
      padding: 20px;
      border-radius: 12px;
      max-height: 60vh;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <!-- LOGIN -->
  <section id="login-section" class="active">
    <h2>Admin Login</h2>
    <input type="email" id="email" placeholder="Admin Email">
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn">Login</button>
    <p id="loginMsg"></p>
  </section>

  <!-- DASHBOARD -->
  <section id="dashboard">
    <canvas id="earth-container"></canvas>
    <h1>üåç Live User Map</h1>
    <div id="user-list"></div>
    <button id="logoutBtn">Logout</button>
  </section>

  <!-- Firebase -->
  <script type="module">
    // Import Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ‚úÖ Replace with your Firebase config
    const firebaseConfig = {
      apiKey: "YOUR-API-KEY",
      authDomain: "YOUR-PROJECT.firebaseapp.com",
      projectId: "YOUR-PROJECT-ID",
      storageBucket: "YOUR-PROJECT.appspot.com",
      messagingSenderId: "SENDER-ID",
      appId: "APP-ID"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // DOM elements
    const loginSection = document.getElementById("login-section");
    const dashboard = document.getElementById("dashboard");
    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const loginMsg = document.getElementById("loginMsg");
    const userList = document.getElementById("user-list");

    // LOGIN
    loginBtn.addEventListener("click", async () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (e) {
        loginMsg.textContent = e.message;
      }
    });

    // LOGOUT
    logoutBtn.addEventListener("click", async () => {
      await signOut(auth);
    });

    // Auth state
    onAuthStateChanged(auth, (user) => {
      if (user) {
        loginSection.classList.remove("active");
        dashboard.classList.add("active");
        loadUsers();
      } else {
        loginSection.classList.add("active");
        dashboard.classList.remove("active");
      }
    });

    // Real-time Firestore Users
    function loadUsers() {
      onSnapshot(collection(db, "users"), (snapshot) => {
        userList.innerHTML = "";
        snapshot.forEach(doc => {
          const data = doc.data();
          const div = document.createElement("div");
          div.textContent = `${data.name || "Unknown"} ‚Äî ${data.email || ""}`;
          userList.appendChild(div);
        });
      });
    }

    // üåç Rotating Earth (Three.js)
    import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.152.0/build/three.module.js";
    let scene = new THREE.Scene();
    let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight,0.1,1000);
    let renderer = new THREE.WebGLRenderer({canvas: document.getElementById("earth-container"), alpha:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    let geometry = new THREE.SphereGeometry(3,64,64);
    let material = new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("https://threejs.org/examples/textures/land_ocean_ice_cloud_2048.jpg")});
    let earth = new THREE.Mesh(geometry,material);
    scene.add(earth);
    camera.position.z = 6;
    function animate(){
      requestAnimationFrame(animate);
      earth.rotation.y += 0.002;
      renderer.render(scene,camera);
    }
    animate();
  </script>
</body>
</html>
